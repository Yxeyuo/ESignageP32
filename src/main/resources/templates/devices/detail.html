<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<!-- Page title fragment -->
<th:block th:fragment="pageTitle">
    <title th:text="'Device: ' + ${device.name}">Device Name</title>
</th:block>

<head th:replace="fragments/layout :: layout_head"></head> <!-- Replace head with layout head fragment -->
<body>
<header th:replace="fragments/header :: header"></header> <!-- Include header fragment -->

<main class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1 th:text="${device.name}">Device Name</h1>
        <a th:href="@{/devices}" class="btn btn-danger">Back</a>
    </div>

    <!-- Device settings form -->
    <div class="card mb-4 shadow-sm">
        <div class="card-header bg-primary text-white">Settings</div>
        <div class="card-body">
            <form th:action="@{/devices/{id}/settings(id=${device.id})}" method="post" class="row g-3">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

                <div class="col-md-6">
                    <label for="name" class="form-label">Name</label>
                    <input type="text" id="name" name="name" th:value="${device.name}" class="form-control" required/>
                </div>

                <div class="col-md-3">
                    <label for="updateIntervalSeconds" class="form-label">Update Interval (s)</label>
                    <input type="number" id="updateIntervalSeconds" name="updateIntervalSeconds" th:value="${device.updateIntervalSeconds}" class="form-control" required/>
                </div>

                <div class="col-md-3">
                    <label for="rotateIntervalSeconds" class="form-label">Rotate Interval (s)</label>
                    <input type="number" id="rotateIntervalSeconds" name="rotateIntervalSeconds" th:value="${device.rotateIntervalSeconds}" class="form-control" required/>
                </div>

                <div class="col-12 text-end">
                    <button type="submit" class="btn btn-success">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- List existing messages -->
    <h2>Messages</h2>
    <ul class="list-group mb-3" th:each="msg : ${device.messages}">
        <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
                <span th:text="${msg.text}"></span>
                (<span th:text="${msg.fontSize}"></span>pt,
                <span th:text="${msg.scroll} ? 'Scroll' : 'Static'"></span>)
            </div>
            <form th:action="@{/devices/{deviceId}/messages/{messageId}/delete(deviceId=${device.id},messageId=${msg.id})}" method="post">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                <button type="submit" class="btn btn-outline-danger btn-sm">Delete</button>
            </form>
        </li>
    </ul>

    <!-- Form to add a new message aligned at bottom -->
    <form th:action="@{/devices/{id}/messages(id=${device.id})}" th:object="${newMessage}" method="post" class="row g-3 mb-4 align-items-end">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <div class="col-md-6">
            <label for="text" class="form-label">New Message</label>
            <input type="text" id="text" th:field="*{text}" class="form-control" placeholder="Message" required/>
        </div>

        <div class="col-md-2">
            <label for="fontSize" class="form-label">Font Size</label>
            <select id="fontSize" th:field="*{fontSize}" class="form-select">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
            </select>
        </div>

        <div class="col-md-2 form-check">
            <input type="checkbox" id="scrollCheck" th:field="*{scroll}" class="form-check-input"/>
            <label for="scrollCheck" class="form-check-label">Scroll</label>
        </div>

        <div class="col-auto">
            <button type="submit" class="btn btn-primary">Add</button>
        </div>
    </form>
</main>

<footer th:replace="fragments/footer :: footer"></footer> <!-- Include footer fragment -->
</body>
</html>
